<div class="briefcase">
  <img src="assets/briefcase.gif" class="logo" alt="logo">
  <span class="slogon">Pointingworks</span>
</div>
<div class="btnsheraders">

  <button class="btn btn-primary" [disabled]="!datauser.history" (click)="GetUserSByid()" type="button"
    data-bs-toggle="offcanvas" data-bs-target="#offcanvasLeft" aria-controls="offcanvasLeft">
    <i class="bi bi-bell"></i>
    <sup>{{ getTotalPointages() }}</sup>
  </button>

  <button class="btn btn-primary" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight"
    aria-controls="offcanvasRight">
    <ng-container *ngIf="datauser.profile_image_url; else defaultImage">
      <img [src]="datauser.profile_image_url" alt="Image de profil" class="enteimg" />
    </ng-container>

    <ng-template #defaultImage><i class="bi bi-person-circle"></i></ng-template>
  </button>

  <app-add-employes [displayStyleChild]="displayStyle" (closeEvent)="closePopup()"></app-add-employes>
</div>
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasRight" aria-labelledby="offcanvasRightLabel">
  <div class="offcanvas-header">

    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <div class="profil">

      <!-- Si profile_image n'est pas défini, utiliser une image par défaut -->
      <img *ngIf="datauser.profile_image" [src]=" datauser.profile_image_url" alt="Image de profil" />
      <p *ngIf="!datauser?.profile_image"><i class="bi bi-person-circle"></i></p>
      <div class="contentprofil">
        <span>{{datauser.name}}</span>
        <span>{{datauser.email}}</span>
        <span>{{datauser.role}}</span>
        <span>{{ datauser.created_at | date:'dd/MM/yyyy HH:mm' }}</span>
      </div>

    </div>
    <div class="basforget">

      <button class="dropdown-item logout" (click)="logout()"> <i class="bi bi-box-arrow-in-left"></i> logout</button>

    </div>

  </div>



</div>


<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasLeft" aria-labelledby="offcanvasLeftLabel">
  <div class="offcanvas-header">
    <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <div class="container mt-3">
      <img src="../../../assets/49.jpg" class="imghitorique" />


      <!-- Affichage du dernier pointage -->
<!-- Affichage du dernier pointage uniquement -->
<div *ngIf="lastPointage">
  <h3>Dernier Pointage</h3>
  <p><strong>Heure d'arrivée :</strong> {{ lastPointage.arrival_date }}</p>
  <p><strong>Heure de départ :</strong> {{ lastPointage.last_departure ? (lastPointage.last_departure | date:'HH:mm:ss') : 'Non encore parti' }}</p>
  <p><strong>Localisation :</strong> {{ lastPointage.location || 'Non précisée' }}</p>
</div>

<!-- Si aucun pointage n'est trouvé -->
<ng-template #noPointage>
  <p>Aucun pointage disponible.</p>
</ng-template>

<!-- Ajout du pointage du jour actuel -->
<div class="today-pointage">
  <h3>Pointage du Jour</h3>
  <div *ngFor="let item of todaySchedule?.pointages">
    <p><strong>Heure d'arrivée :</strong> {{ item.arrival_date || 'Non pointé' }}</p>
    <p><strong>Heure de départ :</strong> {{ item.last_departure ? (item.last_departure  | date:'HH:mm:ss') : 'Non encore parti' }}</p>
    <p><strong>Localisation :</strong> {{ item.location || 'Non précisée' }}</p>
  </div>
  <div *ngIf="!todaySchedule">
    <p>Aucun pointage pour aujourd'hui.</p>
  </div>
</div>

    </div>
  </div>
</div>